{% extends "dashboard.html" %}

{% block container_class %}justify-content-start align-items-start{% endblock %}

{% block content %}
<div class="container-fluid m-4">
<!-- Título y botón para agregar nuevo aspirante -->
    <div class="row mb-3">
        <div class=" d-flex col justify-content-between align-items-center">
            <h3 class="fw-bold m-0">Gestión de Aspirantes</h3>
            {% if "Secretaria Talento Humano" in user_groups %}
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#nuevoAspiranteModal">
                Nuevo Aspirante
            </button>
            {% endif %}
        </div>
    </div>

<!-- Tabla de aspirantes en estado 'Pendiente' -->
    <h4 class="mb-2">Aspirantes Pendientes</h4>

    <!-- Formulario de búsqueda -->
    <form method="GET" class="mb-2">
        <div class="row col d-flex justify-content-start align-items-center">
            <div class="position-relative col-md-3">
                <input type="text" name="aspirante_pendiente" id="filtroInput" class="form-control filtro-input" placeholder="Buscar por nombre, número de documento o rol" value="{{ aspirante_pendiente }}">
                <!-- Icono de "X" para borrar el filtro -->
                <span id="clearFilter" class="position-absolute top-50 end-0 translate-middle-y me-3" style="cursor: pointer; display: none;">
                    <i class="bi bi-x-circle text-muted fs-5"></i>
                </span>
            </div>
            <div class="col-md-auto">
                <button type="submit" class="btn btn-filtrar">Filtrar</button>
            </div>
        </div>
    </form>

    <!-- Tabla de datos -->
    <div class="row">
        <div class="col-12">
            <div class="table-responsive">
                <table class="table table-striped table-hover mb-3 align-middle">
                    <thead class="thead-dark">
                        <tr class="text-center">
                            <th scope="col">Nombre Completo</th>
                            <th scope="col">Rol</th>
                            <th scope="col">Cargo</th>
                            <th scope="col">Estado</th>
                            <th scope="col">Hoja de Vida</th>
                            <th scope="col">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for usuario in page_obj_pendientes %}
                        <tr>
                            <td>
                                {{ usuario.primer_nombre }}
                                {% if usuario.segundo_nombre %} {{ usuario.segundo_nombre }}{% endif %}
                                {{ usuario.primer_apellido }}
                                {% if usuario.segundo_apellido %} {{ usuario.segundo_apellido }}{% endif %}
                            </td>
                            <td>
                                {{ usuario.fk_rol.rol }} - {{ usuario.fk_rol.descripcion }}
                            </td>
                            <td>
                                {{ usuario.cargo }}
                            </td>
                            <td class="text-center">
                                {{ usuario.estado_revision }}
                            </td>
                            <td class="text-center">
                                {% if usuario.url_hoja_de_vida %}
                                <a href="{{ usuario.url_hoja_de_vida }}" id="revisarHojaDeVida" target="_blank" class="text-decoration-none">Revisar</a>
                                {% else %}
                                No Aplica
                                {% endif %}
                            </td>
                            <td class="d-flex justify-content-center gap-3">
                                <a href="#" class="btn btn-editar d-flex justify-content-center align-items-center">
                                    <i class="bi bi-pencil-square"></i>
                                </a>
                                <a href="#" class="btn btn-ver-info d-flex justify-content-center align-items-center">
                                    <i class="bi bi-eye"></i>
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Paginación para la tabla de aspirantes en estado 'Pendiente' -->
    <nav class="mt-2">
        <ul class="pagination justify-content-end">
            {% if page_obj_pendientes.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?page_pendientes={{ page_obj_pendientes.previous_page_number }}&aspirante_pendiente={{ query }}">
                    <i class="bi bi-caret-left-fill"></i>
                </a>
            </li>
            {% endif %}
            <li class="page-item disabled">
                <span class="page-link">Página {{ page_obj_pendientes.number }} de {{ page_obj_pendientes.paginator.num_pages }}</span>
            </li>
            {% if page_obj_pendientes.has_next %}
            <li class="page-item">
                <a class="page-link" href="?page_pendientes={{ page_obj_pendientes.next_page_number }}&aspirante_pendiente={{ query }}">
                    <i class="bi bi-caret-right-fill"></i>
                </a>
            </li>
            {% endif %}
        </ul>
    </nav>

<!-- Separador -->
    <div class="d-flex align-items-center justify-content-center divider mb-2">
        <hr class="w-100">
    </div>

<!-- Tabla de aspirantes en estado 'Rechazado' -->
    <h4 class="mb-2">Aspirantes Rechazados</h4>

    <!-- Formulario de búsqueda -->
    <form method="GET" class="mb-2">
        <div class="row col d-flex justify-content-start align-items-center">
            <div class="col-md-3">
                <input type="text" name="aspirante_rechazado" id="filtroInput" class="form-control filtro-input" placeholder="Buscar por nombre, documento o rol" value="{{ aspirante_rechazado }}">
                    <!-- Icono de "X" para borrar el filtro -->
                <span id="clearRechazadosFilter" class="position-absolute top-50 end-0 translate-middle-y me-3" style="cursor: pointer; display: none;">
                    <i class="bi bi-x-circle text-muted fs-5"></i>
                </span>
            </div>
            <div class="col-md-auto">
                <button type="submit" class="btn btn-filtrar">Filtrar</button>
            </div>
        </div>
    </form>

    <!-- Tabla de datos -->
    <div class="row">
        <div class="col-12">
            <div class="table-responsive">
                <table class="table table-striped table-hover mb-3 align-middle">
                    <thead class="thead-dark">
                        <tr class="text-center">
                            <th scope="col">Nombre Completo</th>
                            <th scope="col">Rol</th>
                            <th scope="col">Cargo</th>
                            <th scope="col">Estado</th>
                            <th scope="col">Hoja de Vida</th>
                            <th scope="col">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for usuario in page_obj_rechazados %}
                        <tr>
                            <td>
                                {{ usuario.primer_nombre }}
                                {% if usuario.segundo_nombre %} {{ usuario.segundo_nombre }}{% endif %}
                                {{ usuario.primer_apellido }}
                                {% if usuario.segundo_apellido %} {{ usuario.segundo_apellido }}{% endif %}
                            </td>
                            <td>
                                {{ usuario.fk_rol.rol }} - {{ usuario.fk_rol.descripcion }}
                            </td>
                            <td>
                                {{ usuario.cargo }}
                            </td>
                            <td class="text-center">
                                {{ usuario.estado_revision }}
                            </td>
                            <td class="text-center">
                                {% if usuario.url_hoja_de_vida %}
                                <a href="{{ usuario.url_hoja_de_vida }}" id="revisarHojaDeVida" target="_blank" class="text-decoration-none">Revisar</a>
                                {% else %}
                                No Aplica
                                {% endif %}
                            </td>
                            <td class="d-flex justify-content-center gap-3">
                                <a href="#" class="btn btn-editar d-flex justify-content-center align-items-center">
                                    <i class="bi bi-pencil-square"></i>
                                </a>
                                <a href="#" class="btn btn-ver-info d-flex justify-content-center align-items-center">
                                    <i class="bi bi-eye"></i>
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Paginación para la tabla de aspirantes en estado 'Rechazado' -->
    <nav class="mt-2">
        <ul class="pagination justify-content-end">
            {% if page_obj_rechazados.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?page_rechazados={{ page_obj_rechazados.previous_page_number }}&aspirante_rechazados={{ query }}">
                    <i class="bi bi-caret-left-fill"></i>
                </a>
            </li>
            {% endif %}
            <li class="page-item disabled">
                <span class="page-link">Página {{ page_obj_rechazados.number }} de {{ page_obj_rechazados.paginator.num_pages }}</span>
            </li>
            {% if page_obj_rechazados.has_next %}
            <li class="page-item">
                <a class="page-link" href="?page_rechazados={{ page_obj_rechazados.next_page_number }}&aspirante_rechazados={{ query }}">
                    <i class="bi bi-caret-right-fill"></i>
                </a>
            </li>
            {% endif %}
        </ul>
    </nav>
</div>

<!-- Modal -->
<div class="modal fade" id="nuevoAspiranteModal" tabindex="-1" aria-labelledby="nuevoAspiranteModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
        <div class="modal-forms modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="nuevoAspiranteModalLabel">Nuevo Aspirante</h3>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-2">
                <form id="formAspirante" method="POST">
                    {% comment %} action="{% url 'agregar_aspirante' %}" {% endcomment %}
                    {% csrf_token %}

                    <!-- Contenido de las pestañas -->
                    <div class="container">
                        <!-- Información Personal -->
                        <div class="container mb-3">
                            <div class="d-flex gap-3 fs-5 fw-bold">
                                <i class="bi bi-person-vcard"></i>Información Personal
                            </div>
                            <div class="row px-3">
                                <div class="col-md-6 mb-2">
                                    <label for="primer_nombre" class="form-label mb-0">Primer Nombre <span class='fw-bold fs-4'>*</span></label>
                                    <input type="text" class="form-control" id="primer_nombre" name="primer_nombre" required>
                                </div>
                                <div class="col-md-6 mb-2">
                                    <label for="segundo_nombre" class="form-label mb-0">Segundo Nombre<span class='fw-bold fs-4'></span></label>
                                    <input type="text" class="form-control" id="segundo_nombre" name="segundo_nombre">
                                </div>

                                <div class="col-md-6 mb-2">
                                    <label for="primer_apellido" class="form-label mb-0">Primer Apellido <span class='fw-bold fs-4'>*</span></label>
                                    <input type="text" class="form-control" id="primer_apellido" name="primer_apellido" required>
                                </div>
                                <div class="col-md-6 mb-2">
                                    <label for="segundo_apellido" class="form-label mb-0">Segundo Apellido<span class='fw-bold fs-4'></span></label>
                                    <input type="text" class="form-control" id="segundo_apellido" name="segundo_apellido">
                                </div>

                                <div class="col-md-6 mb-2">
                                    <label for="fk_rol" class="form-label mb-0">Rol <span class='fw-bold fs-4'>*</span></label>
                                    <select class="form-select" id="fk_rol" name="fk_rol" required>
                                        <option value="" selected>Seleccione</option>
                                        {% for rol in rol_list %}
                                            <option value="{{ rol.id }}">{{ rol.rol }} - {{ rol.descripcion }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-md-6 mb-2">
                                    <label for="cargo" class="form-label mb-0">Cargo <span class='fw-bold fs-4'>*</span></label>
                                    <input type="text" class="form-control" id="cargo" name="cargo" required>
                                </div>

                                <div class="col-md-6 mb-2">
                                    <label for="fecha_nacimiento" class="form-label mb-0">Fecha de Nacimiento <span class='fw-bold fs-4'>*</span></label>
                                    <input type="date" class="form-control" id="fecha_nacimiento" name="fecha_nacimiento" required>
                                </div>
                                <div class="col-md-6 mb-2">
                                    <label for="lugar_nacimiento" class="form-label mb-0">Lugar de Nacimiento<span class='fw-bold fs-4'></span></label>
                                    <input type="text" class="form-control" id="lugar_nacimiento" name="lugar_nacimiento">
                                </div>

                                <div class="col-md-6 mb-2">
                                    <label for="fk_tipo_documento" class="form-label mb-0">Tipo de Documento <span class='fw-bold fs-4'>*</span></label>
                                    <select class="form-select" id="fk_tipo_documento" name="fk_tipo_documento" required>
                                        <option value="" selected>Seleccione</option>
                                        {% for tipo in tipos_documento_list %}
                                            <option value="{{ tipo.id }}">{{ tipo.tipo_documento }} - {{ tipo.descripcion }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-md-6 mb-2">
                                    <label for="numero_documento" class="form-label mb-0">Número de Documento <span class='fw-bold fs-4'>*</span></label>
                                    <input type="number" class="form-control" id="numero_documento" name="numero_documento" required>
                                </div>

                                <div class="col-md-6 mb-2">
                                    <label for="fecha_expedicion_documento" class="form-label mb-0">Fecha de Expedición del Documento<span class='fw-bold fs-4'>   </span></label>
                                    <input type="date" class="form-control" id="fecha_expedicion_documento" name="fecha_expedicion_documento">
                                </div>
                                <div class="col-md-6 mb-2">
                                    <label for="lugar_expedicion_documento" class="form-label mb-0">Lugar de Expedición del Documento<span class='fw-bold fs-4'></span></label>
                                    <input type="text" class="form-control" id="lugar_expedicion_documento" name="lugar_expedicion_documento">
                                </div>

                                <div class="col-md-6 mb-2">
                                    <label for="sexo" class="form-label mb-0">Sexo<span class='fw-bold fs-4'></span></label>
                                    <select class="form-select" id="sexo" name="sexo">
                                        <option value="" selected>Seleccione</option>
                                        <option value="Masculino">Masculino</option>
                                        <option value="Femenino">Femenino</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-2">
                                    <label for="correo_personal" class="form-label mb-0">Correo Personal <span class='fw-bold fs-4'>*</span></label>
                                    <input type="email" class="form-control" id="correo_personal" name="correo_personal" required>
                                </div>

                                <div class="col-md-6 mb-2">
                                    <label for="celular" class="form-label mb-0">Celular <span class='fw-bold fs-4'>*</span></label>
                                    <input type="number" class="form-control" id="celular" name="celular" required>
                                </div>
                                <div class="col-md-6 mb-2">
                                    <label for="telefono_fijo" class="form-label mb-0">Teléfono Fijo<span class='fw-bold fs-4'></span></label>
                                    <input type="number" class="form-control" id="telefono_fijo" name="telefono_fijo">
                                </div>

                                <div class="col-md-6 mb-2">
                                    <label for="direccion_residencia" class="form-label mb-0">Dirección de Residencia<span class='fw-bold fs-4'></span></label>
                                    <input type="text" class="form-control" id="direccion_residencia" name="direccion_residencia">
                                </div>
                                <div class="col-md-6 mb-2">
                                    <label for="departamento_residencia" class="form-label mb-0">Departamento de Residencia <span class='fw-bold fs-4'>*</span></label>
                                    <select type="text" class="form-select" id="departamento_residencia" name="departamento_residencia" required>
                                        <option value="" selected>Seleccione</option>
                                        {% for departamento in departamento_list %}
                                            <option value="{{ departamento.nombre }}">{{ departamento.nombre }}</option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <div class="col-md-6 mb-2">
                                    <label for="ciudad_residencia" class="form-label mb-0">Ciudad de Residencia<span class='fw-bold fs-4'></span></label>
                                    <input type="text" class="form-control" id="ciudad_residencia" name="ciudad_residencia">
                                </div>
                                <div class="col-md-6 mb-2">
                                    <label for="barrio_residencia" class="form-label mb-0">Barrio de Residencia<span class='fw-bold fs-4'></span></label>
                                    <input type="text" class="form-control" id="barrio_residencia" name="barrio_residencia">
                                </div>

                                <div class="col-md-6 mb-2">
                                    <label for="estado_civil" class="form-label mb-0">Estado Civil<span class='fw-bold fs-4'></span></label>
                                    <select type="text" class="form-select" id="estado_civil" name="estado_civil">
                                        <option value="" selected>Seleccione</option>
                                        <option value="Soltero (a)">Soltero (a)</option>
                                        <option value="Casado (a)">Casado (a)</option>
                                        <option value="Unión Libre">Unión Libre</option>
                                        <option value="Soltero (a)">Separado (a)</option>
                                        <option value="Divorciado (a)">Divorciado (a)</option>
                                        <option value="Viudo (a)">Viudo (a)</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-2">
                                    <label for="ultimo_nivel_estudio" class="form-label mb-0">Último Nivel de Estudio <span class='fw-bold fs-4'>*</span></label>
                                    <select class="form-select" id="ultimo_nivel_estudio" name="ultimo_nivel_estudio" required>
                                        <option value="" selected>Seleccione</option>
                                        {% for nivel in niveles_academicos_list %}
                                            <option value="{{ nivel.id }}">{{ nivel.nombre }}</option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <div class="col-md-6 mb-2">
                                    <label for="eps" class="form-label mb-0">EPS <span class='fw-bold fs-4'>*</span></label>
                                    <select class="form-select" id="eps" name="eps" required>
                                        <option value="" selected>Seleccione</option>
                                        {% for eps in eps_list %}
                                            <option value="{{ eps.nombre }}">{{ eps.nombre }}</option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <div class="col-md-6 mb-2">
                                    <label for="afp" class="form-label mb-0">AFP <span class='fw-bold fs-4'>*</span></label>
                                    <select type="text" class="form-select" id="afp" name="afp" required>
                                        <option value="" selected>Seleccione</option>
                                        {% for afp in afp_list %}
                                            <option value="{{ afp.nombre }}">{{ afp.nombre }}</option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <div class="col-md-8">
                                    <label for="url_hoja_de_vida" class="form-label mb-0">URL Hoja de Vida <span class='fw-bold fs-4'>*</span></label>
                                    <input type="url" class="form-control" id="url_hoja_de_vida" name="url_hoja_de_vida" required>
                                </div>
                                <div class="col-md-4">
                                    <label for="estado_revision" class="form-label mb-0">Estado de Revisión <span class='fw-bold fs-4'></span></label>
                                    <input type="text" class="form-control" id="estado_revision" name="estado_revision" value="Pendiente" disabled required>
                                </div>
                            </div>
                        </div>

                        <!-- Separador -->
                        <div class="d-flex align-items-center justify-content-center divider">
                            <hr class="w-100">
                        </div>

                        <!-- Detalles Académicos -->
                        <div class="container mb-3">
                            <div class="d-flex gap-3 fs-5 fw-bold">
                                <i class="bi bi-mortarboard"></i>Detalles Académicos
                            </div>
                            <!-- Botón para registrar información académica -->
                            <div class="text-end mb-2 px-2">
                                <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modalRegistrarAcademico">
                                    Registrar información académica
                                </button>
                            </div>
                        
                            <!-- Tabla de Detalles Académicos -->
                            <div class="table-responsive px-2">
                                <table class="table table-bordered table-hover mb-0">
                                    <thead>
                                        <tr>
                                            <th>Institución</th>
                                            <th>Título Obtenido</th>
                                            <th>Nivel Académico</th>
                                            <th>Fecha de Graduación</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tablaAcademica">
                                        <!-- Aquí se agregarán dinámicamente los registros -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Separador -->
                        <div class="d-flex align-items-center justify-content-center divider">
                            <hr class="w-100">
                        </div>

                        <!-- Experiencia Laboral -->
                        <div class="container mb-2">
                            <div class="d-flex gap-3 fs-5 fw-bold">
                                <i class="bi bi-briefcase"></i>Experiencia Laboral
                            </div>
                            <!-- Botón para registrar información laboral -->
                            <div class="text-end mb-2 px-2">
                                <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modalRegistrarLaboral">
                                    Registrar información laboral
                                </button>
                            </div>

                            <!-- Tabla de Experiencia Laboral -->
                            <div class="table-responsive px-2">
                                <table class="table table-bordered table-hover mb-0">
                                    <thead>
                                        <tr>
                                            <th>Empresa</th>
                                            <th>Cargo</th>
                                            <th>Fecha de Inicio</th>
                                            <th>Fecha de Fin</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tablaExperiencia">
                                        <!-- Aquí se agregarán dinámicamente los registros -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Botón para enviar el formulario -->
            <div class="modal-footer d-flex justify-content-between align-items-center">
                <!-- Nota -->
                <p class='mensaje-info fs-5'><span class='fw-bold'>NOTA:</span> Los campos marcados con ' <span class='fw-bold'>*</span> ' son obligatorios.</p>

                <button type="submit" class="btn btn-primary" form="formAspirante">Enviar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Registrar Información Laboral -->
<div class="modal fade" id="modalRegistrarLaboral" tabindex="-1" aria-labelledby="modalRegistrarLaboralLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalRegistrarLaboralLabel">Registrar Información Laboral</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formLaboral">
                    <div class="mb-3">
                        <label for="empresa" class="form-label">Empresa</label>
                        <input type="text" class="form-control" id="empresa" name="empresa" required>
                    </div>
                    <div class="mb-3">
                        <label for="cargo" class="form-label">Cargo</label>
                        <input type="text" class="form-control" id="cargo" name="cargo" required>
                    </div>
                    <div class="mb-3">
                        <label for="fechaInicio" class="form-label">Fecha de Inicio</label>
                        <input type="date" class="form-control" id="fechaInicio" name="fechaInicio" required>
                    </div>
                    <div class="mb-3">
                        <label for="fechaFin" class="form-label">Fecha de Fin</label>
                        <input type="date" class="form-control" id="fechaFin" name="fechaFin">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="guardarLaboral">Guardar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Registrar Información Académica -->
<div class="modal fade" id="modalRegistrarAcademico" tabindex="-1" aria-labelledby="modalRegistrarAcademicoLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalRegistrarAcademicoLabel">Registrar Información Académica</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="formAcademico">
                    <div class="mb-3">
                        <label for="institucion" class="form-label">Institución</label>
                        <input type="text" class="form-control" id="institucion" name="institucion" required>
                    </div>
                    <div class="mb-3">
                        <label for="tituloObtenido" class="form-label">Título Obtenido</label>
                        <input type="text" class="form-control" id="tituloObtenido" name="tituloObtenido" required>
                    </div>
                    <div class="mb-3">
                        <label for="nivelAcademico" class="form-label">Nivel Académico</label>
                        <select class="form-select" id="nivelAcademico" name="nivelAcademico" required>
                            <option value="" selected>Seleccione</option>
                            <option value="Primaria">Primaria</option>
                            <option value="Secundaria">Secundaria</option>
                            <option value="Técnico">Técnico</option>
                            <option value="Tecnológico">Tecnológico</option>
                            <option value="Profesional">Profesional</option>
                            <option value="Posgrado">Posgrado</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="fechaGraduacion" class="form-label">Fecha de Graduación</label>
                        <input type="date" class="form-control" id="fechaGraduacion" name="fechaGraduacion" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="guardarAcademico">Guardar</button>
            </div>
        </div>
    </div>
</div>

<script>
    // Variables para Aspirantes Pendientes
    const filtroInput = document.getElementById("filtroInput");
    const clearFilter = document.getElementById("clearFilter");

    // Variables para Aspirantes Rechazados
    const filtroRechazadosInput = document.getElementById("filtroRechazadosInput");
    const clearRechazadosFilter = document.getElementById("clearRechazadosFilter");

    // Función General para manejar "X" en filtros
    function handleClearFilter(input, clearIcon) {
        // Mostrar la "X" si el input tiene texto
        input.addEventListener("input", function () {
            if (input.value) {
                clearIcon.style.display = "block";
            } else {
                clearIcon.style.display = "none";
            }
        });

        // Limpiar el input y recargar la página
        clearIcon.addEventListener("click", function () {
            input.value = ""; // Limpiar el input
            clearIcon.style.display = "none";

            // Recargar la página sin parámetros de filtro
            window.location.href = window.location.pathname;
        });

        // Mostrar la "X" si el input ya tiene un valor preexistente
        if (input.value) {
            clearIcon.style.display = "block";
        }
    }

    // Aplicar la funcionalidad a ambos filtros
    handleClearFilter(filtroInput, clearFilter); // Aspirantes Pendientes
    handleClearFilter(filtroRechazadosInput, clearRechazadosFilter); // Aspirantes Rechazados
</script>

<script>
    document.getElementById("guardarLaboral").addEventListener("click", function () {
        // Obtener valores del formulario
        const empresa = document.getElementById("empresa").value;
        const cargo = document.getElementById("cargo").value;
        const fechaInicio = document.getElementById("fechaInicio").value;
        const fechaFin = document.getElementById("fechaFin").value || "Actual";

        // Crear una nueva fila en la tabla
        const nuevaFila = `
            <tr>
                <td>${empresa}</td>
                <td>${cargo}</td>
                <td>${fechaInicio}</td>
                <td>${fechaFin}</td>
                <td>
                    <button class="btn btn-danger btn-sm" onclick="eliminarFila(this)">Eliminar</button>
                </td>
            </tr>
        `;
    
        // Insertar la fila en la tabla
        document.getElementById("tablaExperiencia").insertAdjacentHTML("beforeend", nuevaFila);
    
        // Limpiar el formulario y cerrar el modal
        document.getElementById("formLaboral").reset();
        bootstrap.Modal.getInstance(document.getElementById("modalRegistrarLaboral")).hide();
    });
    
    // Función para eliminar una fila
    function eliminarFila(boton) {
        boton.closest("tr").remove();
    }    
</script>

<script>
    document.getElementById("guardarAcademico").addEventListener("click", function () {
        // Obtener valores del formulario
        const institucion = document.getElementById("institucion").value;
        const tituloObtenido = document.getElementById("tituloObtenido").value;
        const nivelAcademico = document.getElementById("nivelAcademico").value;
        const fechaGraduacion = document.getElementById("fechaGraduacion").value;
    
        // Validación básica
        if (!institucion || !tituloObtenido || !nivelAcademico || !fechaGraduacion) {
            alert("Por favor complete todos los campos obligatorios.");
            return;
        }
    
        // Crear una nueva fila en la tabla
        const nuevaFila = `
            <tr>
                <td>${institucion}</td>
                <td>${tituloObtenido}</td>
                <td>${nivelAcademico}</td>
                <td>${fechaGraduacion}</td>
                <td>
                    <button class="btn btn-danger btn-sm" onclick="eliminarFila(this)">Eliminar</button>
                </td>
            </tr>
        `;
    
        // Insertar la fila en la tabla
        document.getElementById("tablaAcademica").insertAdjacentHTML("beforeend", nuevaFila);
    
        // Limpiar el formulario y cerrar el modal
        document.getElementById("formAcademico").reset();
        bootstrap.Modal.getInstance(document.getElementById("modalRegistrarAcademico")).hide();
    });
    
    // Función para eliminar una fila
    function eliminarFila(boton) {
        boton.closest("tr").remove();
    }    
</script>

{% endblock %}